<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Numerical approximation · NumericalExample.jl</title><meta name="title" content="Numerical approximation · NumericalExample.jl"/><meta property="og:title" content="Numerical approximation · NumericalExample.jl"/><meta property="twitter:title" content="Numerical approximation · NumericalExample.jl"/><meta name="description" content="Documentation for NumericalExample.jl."/><meta property="og:description" content="Documentation for NumericalExample.jl."/><meta property="twitter:description" content="Documentation for NumericalExample.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">NumericalExample.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../theory/">Theory</a></li><li class="is-active"><a class="tocitem" href>Numerical approximation</a><ul class="internal"><li><a class="tocitem" href="#Defining-the-model"><span>Defining the model</span></a></li><li><a class="tocitem" href="#Coding-the-relevant-equilibrium-conditions"><span>Coding the relevant equilibrium conditions</span></a></li><li><a class="tocitem" href="#Steady-state-calculation"><span>Steady state calculation</span></a></li><li><a class="tocitem" href="#Spectral-approximation"><span>Spectral approximation</span></a></li><li><a class="tocitem" href="#Solving-the-model"><span>Solving the model</span></a></li><li><a class="tocitem" href="#Utilities"><span>Utilities</span></a></li></ul></li><li><a class="tocitem" href="../application/">Simple comparative statics</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Numerical approximation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Numerical approximation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/tpapp/NumericalExample.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/tpapp/NumericalExample.jl/blob/master/docs/src/numerical.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Numerical-approximation"><a class="docs-heading-anchor" href="#Numerical-approximation">Numerical approximation</a><a id="Numerical-approximation-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-approximation" title="Permalink"></a></h1><h2 id="Defining-the-model"><a class="docs-heading-anchor" href="#Defining-the-model">Defining the model</a><a id="Defining-the-model-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-the-model" title="Permalink"></a></h2><p>We set up a container for the model parameters, but it is not exported from the module.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NumericalExample.ModelParameters" href="#NumericalExample.ModelParameters"><code>NumericalExample.ModelParameters</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A container for the model parameters. Use <a href="#NumericalExample.model_parameters"><code>model_parameters</code></a> to create, which performs some simple checks.</p><ul><li><p><code>θ</code>: weight on (log) consumption in period utility</p></li><li><p><code>β</code>: discount factor</p></li><li><p><code>α</code>: capital share</p></li><li><p><code>δ</code>: depreciation</p></li><li><p><code>τ_k</code>: tax rate on capital returns</p></li><li><p><code>τ_ℓ</code>: tax rate on wages</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/NumericalExample.jl/blob/a76bac44d9f94484b6509854e7810302287c1e9c/src/NumericalExample.jl#L21-L26">source</a></section></article><p>We use a function to instantiate it, which is better style in Julia and allows for seamless extension of the interface later.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NumericalExample.model_parameters" href="#NumericalExample.model_parameters"><code>NumericalExample.model_parameters</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">model_parameters(; θ, β, α, δ, τ_k, τ_ℓ)
</code></pre><p>Create a value that holds the parameters of the model.</p><p><strong>Keyword arguments</strong></p><ul><li><code>θ</code>: the parameter <span>$θ \log(c) + (1-θ) \log(1-ℓ)$</span> in the utility function</li><li><code>β</code>: the discount factor</li><li><code>α</code>: the capital share, in the production function <span>$k^α ℓ^{1-α}$</span></li><li><code>δ</code>: the depreciation rate</li><li><code>τ_k</code>, <code>τ_ℓ</code>: tax rates for capital and labor, respectively</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/NumericalExample.jl/blob/a76bac44d9f94484b6509854e7810302287c1e9c/src/NumericalExample.jl#L48">source</a></section></article><h2 id="Coding-the-relevant-equilibrium-conditions"><a class="docs-heading-anchor" href="#Coding-the-relevant-equilibrium-conditions">Coding the relevant equilibrium conditions</a><a id="Coding-the-relevant-equilibrium-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Coding-the-relevant-equilibrium-conditions" title="Permalink"></a></h2><p>We code the elements of the model in simple functions, which are easier to check and debug.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NumericalExample.rent_and_wage" href="#NumericalExample.rent_and_wage"><code>NumericalExample.rent_and_wage</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">rent_and_wage(model, k, ℓ)
</code></pre><p>Calculate the rent and the wage in the <code>model</code>, using capital <code>k</code> and labor <code>ℓ</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/NumericalExample.jl/blob/a76bac44d9f94484b6509854e7810302287c1e9c/src/NumericalExample.jl#L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NumericalExample.tax_revenue" href="#NumericalExample.tax_revenue"><code>NumericalExample.tax_revenue</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">tax_revenue(model, k, ℓ)
</code></pre><p>Calculate the tax revenue in the <code>model</code>, using capital <code>k</code> and labor <code>ℓ</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/NumericalExample.jl/blob/a76bac44d9f94484b6509854e7810302287c1e9c/src/NumericalExample.jl#L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NumericalExample.period_budget" href="#NumericalExample.period_budget"><code>NumericalExample.period_budget</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">period_budget(model, k, ℓ)
</code></pre><p>Calculate the budget of the agent each period (can be spent on consumption and next-period capital).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/NumericalExample.jl/blob/a76bac44d9f94484b6509854e7810302287c1e9c/src/NumericalExample.jl#L97">source</a></section></article><p>We encapsulate equilibrium conditions into two simple functions.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NumericalExample.euler_residual" href="#NumericalExample.euler_residual"><code>NumericalExample.euler_residual</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">euler_residual(model; c, k′, ℓ′, c′)
</code></pre><p>Calculate the residual of the intertemporal equilibrium condition (Euler equation) at a given point in time.</p><p><code>c</code> is consumption for this period, <code>k′</code>, <code>ℓ′</code>, <code>c′</code> are capital, labor, and consumption <em>next</em> period, respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/NumericalExample.jl/blob/a76bac44d9f94484b6509854e7810302287c1e9c/src/NumericalExample.jl#L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NumericalExample.labor_FOC_residual" href="#NumericalExample.labor_FOC_residual"><code>NumericalExample.labor_FOC_residual</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">labor_FOC_residual(model; k, ℓ, c)
</code></pre><p>Calculate the residual of the intratemporal first order condition.</p><p><code>k</code>, <code>ℓ</code>, <code>c</code> are capital, labor, and consumption this period, respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/NumericalExample.jl/blob/a76bac44d9f94484b6509854e7810302287c1e9c/src/NumericalExample.jl#L126">source</a></section></article><h2 id="Steady-state-calculation"><a class="docs-heading-anchor" href="#Steady-state-calculation">Steady state calculation</a><a id="Steady-state-calculation-1"></a><a class="docs-heading-anchor-permalink" href="#Steady-state-calculation" title="Permalink"></a></h2><p>Then we code the steady state as derived in the previous section.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NumericalExample.calculate_steady_state" href="#NumericalExample.calculate_steady_state"><code>NumericalExample.calculate_steady_state</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_steady_state(model)
</code></pre><p>Calculate the steady state solution, returning a container with fields <code>c̄</code>, <code>k̄</code>, <code>ℓ̄</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/NumericalExample.jl/blob/a76bac44d9f94484b6509854e7810302287c1e9c/src/NumericalExample.jl#L139">source</a></section></article><h2 id="Spectral-approximation"><a class="docs-heading-anchor" href="#Spectral-approximation">Spectral approximation</a><a id="Spectral-approximation-1"></a><a class="docs-heading-anchor-permalink" href="#Spectral-approximation" title="Permalink"></a></h2><p>We solve the full model in the time domain, using Chebyshev polynomials transformed to <span>$[0, \infty]$</span> (<a href="../#boyd2001chebyshev">Boyd, 2001</a>). </p><p>The method is similar to (<a href="../#judd_parametric_2002">Judd, 2002</a>), except that we find that rational transformations of Chebyshev polynomials work well without building in exponential decay. Also, in contrast to a lot of texts, we approximate not only <span>$k(t)$</span> but also <span>$c(t)$</span> and <span>$\ell(t)$</span>, instead of deriving them from equilibrium conditions. This leads to a larger parameter space for the approximation, but ensures that the residuals are always well-defined and have finite derivatives, leading the solver quickly to the equilibrium. This requires that we transform values to be positive (for <span>$c(t)$</span> and <span>$k(t)$</span>) and to be within <span>$(0, 1)$</span> (for <span>$\ell(t)$</span>).</p><p>We first define the approximation setup.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NumericalExample.approximation_setup" href="#NumericalExample.approximation_setup"><code>NumericalExample.approximation_setup</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">approximation_setup(
;
    basis0,
    mid_t,
    positive_transformation,
    unit_transformation
)
</code></pre><p>Return a value that contains all parameters for the approximation.</p><ul><li><p><code>basis0</code>: the untransformed basis (with a finite domain), defaults to a Chebyshev approximation with 10 elements, nodes on the interior of the domain</p></li><li><p><code>mid_t</code>: the time period for more or less the middle node. Approximately, it should be the time horizon we are interested in, but the method is fairly accurate without determining this precisely</p></li><li><p><code>positive_transformation</code>, <code>unit_transformation</code>: functions that transform <span>$ℝ$</span> to <span>$(0, ∞)$</span> and <span>$(0, 1)$</span>. The defaults are <code>exp</code> and <code>logistic</code>, and you probably do not need to change these.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/NumericalExample.jl/blob/a76bac44d9f94484b6509854e7810302287c1e9c/src/NumericalExample.jl#L171">source</a></section></article><p>Spectral approximations usually work best if we have a reasonably good initial guess. For this we use the steady state solution <span>$\forall t &gt; 0$</span>, since that is always a solution with <span>$k(0) = k_0$</span> for any initial capital level <span>$k_0$</span>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NumericalExample.calculate_initial_guess" href="#NumericalExample.calculate_initial_guess"><code>NumericalExample.calculate_initial_guess</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_initial_guess(approx, steady_state)
</code></pre><p>Calculate an initial guess for the solution from the steady state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/NumericalExample.jl/blob/a76bac44d9f94484b6509854e7810302287c1e9c/src/NumericalExample.jl#L196">source</a></section></article><h2 id="Solving-the-model"><a class="docs-heading-anchor" href="#Solving-the-model">Solving the model</a><a id="Solving-the-model-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-the-model" title="Permalink"></a></h2><p>To solve the model, we define a mapping from the approximation parameters to the residuals, and use a trust region method to solve for the roots, with automatic differentiation.</p><p>The solver is encapsulated into the function below.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NumericalExample.solve_model" href="#NumericalExample.solve_model"><code>NumericalExample.solve_model</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">solve_model(model, k0; approx, tol)
</code></pre><p>Solve the <code>model</code> using the approximation setup in <code>approx</code>, with initial capital <code>k0</code>.</p><p><code>tol</code> is used for numerical tolerance.</p><p>Return an object that has fields <code>c̃</code>, <code>k̃</code>, <code>ℓ̃</code> for the approximated functions on <span>$[0,∞)$</span>, and a boolean <code>converged</code>, for checking convergence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/NumericalExample.jl/blob/a76bac44d9f94484b6509854e7810302287c1e9c/src/NumericalExample.jl#L282">source</a></section></article><h2 id="Utilities"><a class="docs-heading-anchor" href="#Utilities">Utilities</a><a id="Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities" title="Permalink"></a></h2><p>We made a simple function to automate plot colors and labeling.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NumericalExample.plot_vs_time" href="#NumericalExample.plot_vs_time"><code>NumericalExample.plot_vs_time</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_vs_time(fs, ts)
plot_vs_time(
    fs,
    ts,
    label;
    colors,
    graph_labels,
    label_relative_offset
)
</code></pre><p>A simple utility function to plot functions <code>fs</code> at times <code>ts</code>. <code>graph_labels</code> labels each graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/NumericalExample.jl/blob/a76bac44d9f94484b6509854e7810302287c1e9c/src/NumericalExample.jl#L308">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Theory</a><a class="docs-footer-nextpage" href="../application/">Simple comparative statics »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Sunday 23 June 2024 09:15">Sunday 23 June 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
